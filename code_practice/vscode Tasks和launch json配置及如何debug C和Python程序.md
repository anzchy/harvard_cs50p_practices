# 原来的Tasks.json 备份

```
{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: clang build active file",
            "command": "/usr/bin/clang",
            "args": [
                "-fcolor-diagnostics",
                "-fansi-escape-codes",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}
```



Launch.json

```
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "(lldb) Attach",
            "type": "cppdbg",
            "request": "attach",
            "program": "enter program name, for example ${workspaceFolder}/a.out",
            "MIMode": "lldb"
        },
        {
            "name": "Python Debugger: Current File",
            "type": "debugpy",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal"
        }
    ]
}
```



# Prompt 修改launch 和 task.json

我想在Mac vs code 本地配置 launch.json 和 tasks.json，这样我可以在本地 debug C 语言程序，但是碰到如下错误，请帮我看看哪里除了问题。

目前我 的 launch.json 如下：

```
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "(lldb) Launch",
            "preLaunchTask": "build",
            "type": "cppdbg",
            "request": "launch",
            "program": "${fileDirname}/../build/${fileBasenameNoExtension}",
            "args": [],
            "stopAtEntry": true,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "externalConsole": true,
            "MIMode": "lldb"
        }
    ]
}

```

Tasks.json 如下：

```
{
	"version": "2.0.0",
	"tasks": [
		{
			"type": "shell",
			"label": "build",
			"command": "/usr/bin/clang",
			"args": [
				"-fdiagnostics-color=always",
				"${file}",
				"-o",
				"${fileDirname}/../build/${fileBasenameNoExtension}",
				"-g"
			],
			"options": {
				"cwd": "${fileDirname}"
			},
			"problemMatcher": [
				"$gcc"
			],
			"group": {
				"kind": "build",
				"isDefault":true
			},
			"detail": "编译器: /usr/bin/clang"
		}
	]
}

```

Debug C 程序时候，出现如下错误：

> launch:program '/Users chengyong/Documents/01_Coding/03_Harvard_CS50P/ harvard_cs50p_practices/ code_practice/../build/buggy' does not exist



>  *  Executing task: /usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/buggy.c -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/../build/buggy -g 
>
> Undefined symbols for architecture arm64:
>   "_get_int", referenced from:
>       _main in buggy-d73d86.o
> ld: symbol(s) not found for architecture arm64
> clang: error: linker command failed with exit code 1 (use -v to see invocation)
>
>  *  The terminal process "/bin/zsh '-l', '-c', '/usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/buggy.c -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/../build/buggy -g'" terminated with exit code: 1. 
>  *  Terminal will be reused by tasks, press any key to close it. 
>
>  *  Executing task: /usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/.vscode/launch.json -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/.vscode/../build/launch -g 
>
> ld: unknown file type in '/Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/.vscode/launch.json'
> clang: error: linker command failed with exit code 1 (use -v to see invocation)
>
>  *  The terminal process "/bin/zsh '-l', '-c', '/usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/.vscode/launch.json -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/.vscode/../build/launch -g'" failed to launch (exit code: 1). 
>  *  Terminal will be reused by tasks, press any key to close it. 



后面我自己改了路径，竟然成功了。



## 如何使得clang debug 时候，把 lcs50 library link 上去。

```
 Executing task: /usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/meow.c -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/meow -g 
```

我们看看命令行完整的命令是这样的。

我如果要 link 的话，需要是这样的。

```
clang -o hello hello.c -lcs50
```



# 最终成功在 vscode 中 debug 的配置如下：

最终我的 launch.json 和 tasks.json 配置如下，注意这里会 pop 新的 terminal windows，方便我输入数字交互。

![image-20240824004017362](../../../../../Library/Application Support/typora-user-images/image-20240824004017362.png)

## launch.json

```
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "(lldb) Launch", 
            "preLaunchTask": "build",
            "type": "cppdbg",
            "request": "launch",
            "program": "${fileDirname}/${fileBasenameNoExtension}",
            "args": [],
            "stopAtEntry": true,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "externalConsole": true, // Set this to true, a new terminal will pop out,for you to interact with
            "MIMode": "lldb"
        }
    ]
}

```

注意 tasks 的 label 和 launch.json 的 preLaunchTask 的数值要一样。

Lldb launch 是 vs code 中 debug 名称

![image-20240824004402811](../../../../../Library/Application Support/typora-user-images/image-20240824004402811.png)

## tasks.json

```
{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "shell",
            "label": "build",
            "command": "/usr/bin/clang",
            "args": [
                "-fdiagnostics-color=always",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}", //和 launch.json 一致
                "-g",
                "-lcs50", // link cs50 的 library
                
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "编译器: /usr/bin/clang"
        }
    ]
}
```



# 如何 debug C code？

打开任何一个 C 文件，打开右上角的 `Debug C/C++ File`

![image-20240824004456741](../../../../../Library/Application Support/typora-user-images/image-20240824004456741.png)

然后选择第一个—— lldb launch

![image-20240824004628234](../../../../../Library/Application Support/typora-user-images/image-20240824004628234.png)

看到 terminal 会显示如下 task，我们可以看到用的是/usr/bin/clang 编译器，然后有 buggy.c 绝对路径；

也有编译后的 buggy 路径，最后还有-lcs50 的Library 链接上了。

```
Executing task: /usr/bin/clang -fdiagnostics-color=always /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/buggy.c -o /Users/chengyong/Documents/01_Coding/03_Harvard_CS50P/harvard_cs50p_practices/code_practice/buggy -g -lcs50 

```

接下来设置断点：在左边点一下红色的点：

技巧就是：

>  在输入数字之后，在进入 for 循环之前设置断点。

![image-20240824005218682](../../../../../Library/Application Support/typora-user-images/image-20240824005218682.png)

右上角程序旁边会有如下显示：

![image-20240824005000275](../../../../../Library/Application Support/typora-user-images/image-20240824005000275.png)

我们点第三个向下箭头——表示 step into，程序会使得第二个单开的 terminal 提示我们输入数字

![image-20240824005246856](../../../../../Library/Application Support/typora-user-images/image-20240824005246856.png)

我们输入 4 ，Enter 之后；会看到左上角 h 变成 4 了。

![image-20240824005315530](../../../../../Library/Application Support/typora-user-images/image-20240824005315530.png)

接着我们继续 step into，到 for 循环中，看执行情况：

这时候马上跳到 for 第一行，i 还没有赋值，是随机生成的 garbage number。

继续 step into

![image-20240824005520086](../../../../../Library/Application Support/typora-user-images/image-20240824005520086.png)

i 变成了 0，证明第一个条件满足，开始执行 for 程序里面的 code：

![image-20240824005628327](../../../../../Library/Application Support/typora-user-images/image-20240824005628327.png)

然后我们看到单独的窗口打印出第一个“#”

![image-20240824005742955](../../../../../Library/Application Support/typora-user-images/image-20240824005742955.png)

如此往复，继续 step into，直到 for loop 执行完。

以上就是 debug 的全过程。



# 特别注意 python 代码 debug 用这个

![image-20240824010227350](../../../../../Library/Application Support/typora-user-images/image-20240824010227350.png)

但最后界面还是复用 C debug 的界面，这里我在 n 输入之后，if  n>0 这里设置断点。

然后提示我输入次数，我输入 4。

![image-20240824010343617](../../../../../Library/Application Support/typora-user-images/image-20240824010343617.png)

然后程序上方的 step into 就可以用了。左边也显示出 variable ，n 设置为 4。然后 不断step into ，我们就可以看到 for 循环的每一步，就像放慢速电影一样。